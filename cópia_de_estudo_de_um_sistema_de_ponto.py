# -*- coding: utf-8 -*-
"""C칩pia de Estudo de um sistema de ponto.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1qT217_FgLneB8_oY5nnfz6THvgjKP3eb
"""
import streamlit as st
import pandas as pd
import numpy as np
from datetime import datetime
from zoneinfo import ZoneInfo

st.set_page_config(page_title="Registro de Ponto", page_icon="游")
st.title("游 Sistema de Registro de Ponto")

#Dados de colaboradores e seus c칩digos
colaboradores = {
    "Fernando": 33,
    "Gustavo": 44,
    "Clara": 45,
    "Eveline": 56,
    "Valmir":37
}

#Tranformar o dicion치rio dos colaboradores em um dataset
Dados = pd.DataFrame(list(colaboradores.items()), columns=['Nome', 'Codigo'])

codigo = st.number_input("Insira seu c칩digo de colaborador:", step=1, format="%d")

# Verifica se o c칩digo existe
Lista_de_codigos = Dados["Codigo"].values
if codigo in Lista_de_codigos:
    nome = Dados.loc[Dados["Codigo"] == codigo, "Nome"].values[0]
    st.success(f"Bem-vindo, {nome}!")

    confirma = st.radio("Confirma seu nome?", ["Sim", "N칚o"])

    if confirma == "Sim":
        opcao = st.selectbox("Escolha uma op칞칚o:", [
            "1 - Entrada",
            "2 - Sa칤da para o almo칞o",
            "3 - Volta para o almo칞o",
            "4 - Sa칤da n칚o programada",
            "5 - Volta da sa칤da n칚o programada",
            "6 - Sa칤da"
        ])

        if st.button("Registrar"):
            agora = datetime.now(ZoneInfo("America/Sao_Paulo"))
            data = agora.date().strftime("%d/%m/%Y")
            hora = agora.time().strftime("%H:%M:%S")

            Dados.loc[Dados["Codigo"] == codigo, "Data"] = data

            campos = {
                "1": "Entrada",
                "2": "Hor치rio de sa칤da",
                "3": "Hor치rio de volta do almo칞o",
                "4": "Hor치rio de sa칤da n칚o programada",
                "5": "Hor치rio de volta da sa칤da n칚o programada",
                "6": "Sa칤da"
            }
            campo_selecionado = campos[opcao.split(" ")[0]]
            Dados.loc[Dados["Codigo"] == codigo, campo_selecionado] = hora
            st.success(f"{campo_selecionado} registrada com sucesso 맙 {hora}!")

            # (Opcional) Salvar altera칞칚o em CSV
            Dados.to_csv("dados_colaboradores.csv", index=False)
    else:
        st.warning("Por favor, contate o PCP para corrigir o c칩digo.")
else:
    if codigo != 0:
        st.error("C칩digo n칚o encontrado. Tente novamente.")
